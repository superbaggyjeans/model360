<html>
<!-- ES EL BO // ANDRES 2.0 -->
<head>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
</head>

<body>
    <a-scene cursor="rayOrigin: mouse">
        <a-assets>
            <!-- Imatges 360 -->
            <img id="ipresentacio" src="assets/imatges/0_general arreglado.jpg">
            <img id="i00" src="assets/imatges/0_generalarre color.jpg">
            <img id="i01" src="assets/imatges/1_1oficines arrre.jpg">
            <img id="i02" src="assets/imatges/2_1abocador arre.jpg">
            <img id="i03" src="assets/imatges/3_plantatransferencia arre.jpg">
            <img id="i04" src="assets/imatges/4_motorbiogas arre.jpg">
            <img id="i05" src="assets/imatges/5_bassesdaigues arres.jpg">
            <img id="i06" src="assets/imatges/6_parcsolar arre.jpg">
            <img id="i07" src="assets/imatges/7_1plantacompostatge arre.jpg">
            <img id="i08" src="assets/imatges/8_novaplanta arree.jpg">
            <img id="i09" src="assets/imatges/9_falconeria arre.jpg">

            <!--imatge del plano-->
            <img id="dibuplano" src="assets/imatges/parc_ambiental_mapa.jpg">

            <!--imatges de banderes-->
            <img id="bes" src="assets/imatges/bes.png">
            <img id="bcat" src="assets/imatges/bcat.png">
            <img id="buk" src="assets/imatges/buk.png">

        </a-assets>

        <a-entity camera look-controls wasd-controls="false"></a-entity>

        <!-- Entorn 360 inicial -->
        <a-sky id="sky" src="#ipresentacio"></a-sky>
        <!-- Mostra les tres banderes -->
        <a-plane id="es" position="-1.5 -0.5 -2" src="#bes" rotation="0 0 0" scale="1 1 1" botocastella></a-plane>
        <a-plane id="cat" position="0 -0.5 -2" src="#bcat" rotation="0 0 0" scale="1 1 1" botocatala></a-plane>
        <a-plane id="uk" position="1.5 -0.5 -2" src="#buk" rotation="0 0 0" scale="1 1 1" botoangles></a-plane>

        <!-- Deixa el mapa a punt per mostrar a la propera-->
        <a-plane id="plano" position="0 -1 -2" src="#dibuplano" rotation="0 0 0" scale="2 1 2"
            visible="false"></a-plane>

        <!-- Punts d'interés a punt de mostrar-->

        <a-sphere id="esfera1" botooficina="" position="0.082 -0.66 -2" radius="0.03" color="blue" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere>

        <a-sphere id="esfera2" botoabocador="" position="-0.50 -0.79 -2" radius="0.03" color="blue" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere>
            
        <a-sphere id="esfera3" botoplanta="" position="-0.70 -0.85 -2" radius="0.03" color="blue" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere>

        <a-sphere id="esfera4" botomotor="" position="-0.74 -0.78 -2" radius="0.03" color="blue" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere> 

        <a-sphere id="esfera5" botobasses="" position="-0.67 -0.96 -2" radius="0.03" color="blue" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere>

        <a-sphere id="esfera6" botosolar="" position="-0.51 -1.11 -2" radius="0.03" color="blue" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere>

        <a-sphere id="esfera7" botocompostatge="" position="0.130 -1.30 -2" radius="0.03" color="blue" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere>

        <a-sphere id="esfera8" botonovaplanta="" position="0.440 -1.10 -2" radius="0.03" color="blue" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere>

        <a-sphere id="esfera9" botofalco="" position="0.180 -0.70 -2" radius="0.03" color="blue" visible="false"
            animation="property: scale; dur: 1000;  to: 1.2 1.2 1.2; dir: alternate;  loop: true"></a-sphere>


        <!-- Element de so -->
        <a-entity id="sound" sound="src: #audio5"></a-entity>
    </a-scene>


    <script>
        const sky = document.querySelector('#sky');
        const sound = document.querySelector('#sound');
        let idioma = "ca"
        const banderaEs = document.querySelector('#es');
        const banderaCat = document.querySelector('#cat');
        const banderaUk = document.querySelector('#uk');
        const esfera1 = document.querySelector('#esfera1');
        const esfera2 = document.querySelector('#esfera2');
        const esfera3 = document.querySelector('#esfera3');
        const esfera4 = document.querySelector('#esfera4');
        const esfera5 = document.querySelector('#esfera5');
        const esfera6 = document.querySelector('#esfera6');
        const esfera7 = document.querySelector('#esfera7');
        const esfera8 = document.querySelector('#esfera8');
        const esfera9 = document.querySelector('#esfera9');
        const mapa = document.querySelector('#plano');

        //elimina el moviment de les tecles del cursor
        document.querySelector("[camera]").removeAttribute("wasd-controls");

        //funció per sonar audio, va a buscar la carpeta de l'idioma
        function playAudio(nomFitxer) {
            const ruta = `assets/audios/${idioma}/${nomFitxer}.mp3`;
            console.log(ruta);
            if (sound.components.sound && sound.components.sound.isPlaying) {
                sound.components.sound.stopSound();
            }
            sound.setAttribute('sound', `src: ${ruta}`);
            sound.components.sound.playSound();
        }


        //si prem boto angles, carrega la imatge 00
        //deixa de mostrar les banderes, mostra el mapa
        //mostra els punts d'interes i sona la locució inicial en l'idioma que toca
        AFRAME.registerComponent("botoangles", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i00'); //Mostra la imatge 0  
                    banderaEs.setAttribute('visible', false);
                    banderaCat.setAttribute('visible', false);
                    banderaUk.setAttribute('visible', false);
                    esfera1.setAttribute('visible', true);
                    esfera2.setAttribute('visible', true);
                    esfera3.setAttribute('visible', true);
                    esfera4.setAttribute('visible', true);
                    esfera5.setAttribute('visible', true);
                    esfera6.setAttribute('visible', true);
                    esfera7.setAttribute('visible', true);
                    esfera8.setAttribute('visible', true);
                    esfera9.setAttribute('visible', true);
                    mapa.setAttribute('visible', true);
                    idioma = "uk"
                    playAudio("Oficinas");  
                })
            }
        });

        AFRAME.registerComponent("botocatala", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i00'); //Mostra la imatge 0  
                    banderaEs.setAttribute('visible', false);
                    banderaCat.setAttribute('visible', false);
                    banderaUk.setAttribute('visible', false);
                    esfera1.setAttribute('visible', true);
                    esfera2.setAttribute('visible', true);
                    esfera3.setAttribute('visible', true);
                    esfera4.setAttribute('visible', true);
                    esfera5.setAttribute('visible', true);
                    esfera6.setAttribute('visible', true);
                    esfera7.setAttribute('visible', true);
                    esfera8.setAttribute('visible', true);
                    esfera9.setAttribute('visible', true);


                    mapa.setAttribute('visible', true);
                    idioma = "cat"
                    playAudio("Oficinas");  
                })
            }
        });

        AFRAME.registerComponent("botocastella", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i00'); //Mostra la imatge 0  
                    banderaEs.setAttribute('visible', false);
                    banderaCat.setAttribute('visible', false);
                    banderaUk.setAttribute('visible', false);
                    esfera1.setAttribute('visible', true);
                    esfera2.setAttribute('visible', true);
                    esfera3.setAttribute('visible', true);
                    esfera4.setAttribute('visible', true);
                    esfera5.setAttribute('visible', true);
                    esfera6.setAttribute('visible', true);
                    esfera7.setAttribute('visible', true);
                    esfera8.setAttribute('visible', true);
                    esfera9.setAttribute('visible', true);

                    mapa.setAttribute('visible', true);
                    idioma = "es"
                    playAudio("Oficinas");  
                })
            }
        });

        AFRAME.registerComponent("botooficina", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i01'); //Mostra la imatge de la torre                
                    if (sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Oficinas");
                })
            }
        });
        AFRAME.registerComponent("botoabocador", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i02'); //Mostra la imatge de la torre                
                    if (sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Abocador");
                })
            }
        });

         AFRAME.registerComponent("botoplanta", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i03'); //Mostra la imatge de la torre                
                    if (sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Planta");
                })
            }
        });

         AFRAME.registerComponent("botomotor", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i04'); //Mostra la imatge de la torre                
                    if (sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Motor-de-biogàs");
                })
            }
        });

        AFRAME.registerComponent("botobasses", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i05'); //Mostra la imatge de la torre                
                    if (sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Basses");
                })
            }
        });

        AFRAME.registerComponent("botosolar", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i06'); //Mostra la imatge de la torre                
                    if (sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Parc-solar");
                })
            }
        });

        AFRAME.registerComponent("botocompostatge", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i07'); //Mostra la imatge de la torre                
                    if (sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Compostatge");
                })
            }
        });

        AFRAME.registerComponent("botonovaplanta", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i08'); //Mostra la imatge de la torre                
                    if (sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Nova");
                })
            }
        });

        AFRAME.registerComponent("botofalco", {
            init: function () {
                this.el.addEventListener("click", (e) => {
                    sky.setAttribute('src', '#i09'); //Mostra la imatge de la torre                
                    if (sound.components.sound.isPlaying) {
                        sound.components.sound.stopSound(); // Para el so si ja s'està reproduint
                    }
                    playAudio("Falconeria");
                })
            }
        });

    </script>
</body>

</html>